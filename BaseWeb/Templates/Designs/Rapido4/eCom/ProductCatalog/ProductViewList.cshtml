@inherits ViewModelTemplate<ProductListViewModel>
@using Dynamicweb.Rendering
@using Dynamicweb.Ecommerce.ProductCatalog
@using System.Web


@{ 
    bool isFeed = !string.IsNullOrEmpty(HttpContext.Current.Request.QueryString.Get("feed")) ? Convert.ToBoolean(HttpContext.Current.Request.QueryString.Get("feed")) : false;

    //Put the ProductListViewModel up in context items
    if (System.Web.HttpContext.Current.Items.Contains("ProductList"))
    {
        System.Web.HttpContext.Current.Items["ProductList"] = Model;
    } 
    else 
    {
        System.Web.HttpContext.Current.Items.Add("ProductList", Model);
    }
}

@if (isFeed) {
    @Model.ToJson()
}


